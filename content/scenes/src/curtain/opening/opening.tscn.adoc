---
title: src/curtain/opening/opening.tscn
---
:toc:

== src / curtain / opening / opening.tscn

=== Diagram
[plantuml]
....
class R as "OpeningCurtain" <<(C,lightgreen) Control>> {
  * pattern
  * center
---
  + set_center()
  + play()
}
class N1 as "Pattern1" <<(N,lightskyblue) Node2D>> {
}
class N2 as "LeftCurtain" <<(P,lightskyblue) Polygon2D>> {
}
class N3 as "RightCurtain" <<(P,lightskyblue) Polygon2D>> {
}
class N4 as "Pattern2" <<(C,lightgreen) ColorRect>> {
}
class N5 as "Pattern3" <<(C,lightgreen) ColorRect>> {
}
class N6 as "AnimationPlayer" <<(A,darkgray) AnimationPlayer>> {
}
R --o N1
R --o N4
R --o N5
R --o N6
N1 --o N2
N1 --o N3
!define _(a,b) a <-[#blue,thickness=2]- b
left to right direction

....





=== Instantiators
* link:/scenes/src/chapters/0/stages/0/stage_0.tscn[res://src/chapters/0/stages/0/stage_0.tscn]


=== Scene Tree
[.scene-tree]
* [.node-name.type-control]#OpeningCurtain# [.node-type.type-control]#Control#
** [.node-name.type-2d]#Pattern1# [.node-type.type-2d]#Node2D#
*** [.node-name.type-2d]#LeftCurtain# [.node-type.type-2d]#Polygon2D#
*** [.node-name.type-2d]#RightCurtain# [.node-type.type-2d]#Polygon2D#
** [.node-name.type-control]#Pattern2# [.node-type.type-control]#ColorRect#
** [.node-name.type-control]#Pattern3# [.node-type.type-control]#ColorRect#
** [.node-name.type-other]#AnimationPlayer# [.node-type.type-other]#AnimationPlayer#


=== Animations
==== Animation_bwqwf

[plantuml]
....
control "Root" as R
participant "$Pattern1\n/RightCurtain" as T0
participant "$Pattern1\n/LeftCurtain" as T1
participant "$Pattern1" as T2
participant "$Pattern2" as T3
participant "$Pattern3" as T5



== Time: 0.0 ==
R  ->  T0 : polygon\n = PackedVector2Array(1920, 1080, 1920, 0, 960, 0, 1920, 540, 960, 1074)
R  ->  T1 : polygon\n = PackedVector2Array(0, 0, 0, 1080, 960, 1080, 9, 548, 960, 0)
R  ->  T2 : visible\n = false
R  ->o  T3 : visible\n = false
R  ->  T3 : material\n = 0.0
R  ->o  T5 : visible\n = false
R  ->  T5 : material\n = 0.5


....
---

==== pattern1

[plantuml]
....
control "Root" as R
participant "$Pattern1\n/RightCurtain" as T0
participant "$Pattern1\n/LeftCurtain" as T1
participant "$Pattern1" as T2
participant "$Pattern2" as T3
participant "$Pattern3" as T4



== Time: 0.0 ==
R  ->  T0 : polygon\n = PackedVector2Array(1920, 1080, 1920, 0, 960, 0, 960, 540, 960, 1080)
R  ->  T1 : polygon\n = PackedVector2Array(0, 0, 0, 1080, 960, 1080, 960, 548, 960, 0)
R  ->  T2 : visible\n = true
R  ->o  T3 : visible\n = false
R  ->o  T4 : visible\n = false
== Time: 0.5 ==
R  ->  T0 : polygon\n = PackedVector2Array(1920, 1080, 1920, 0, 960, 0, 1920, 540, 960, 1080)
R  ->  T1 : polygon\n = PackedVector2Array(0, 0, 0, 1080, 960, 1080, 0, 548, 960, 0)
== Time: 1.0 ==
R  ->  T0 : polygon\n = PackedVector2Array(1920, 1080, 1920, 0, 1920, 0, 1920, 540, 1920, 1080)
R  ->  T1 : polygon\n = PackedVector2Array(0, 0, 0, 1080, 0, 1080, 0, 548, 0, 0)


....
---

==== pattern2

[plantuml]
....
control "Root" as R
participant "$Pattern2" as T0
participant "$Pattern1" as T1
participant "$Pattern3" as T3



== Time: 0.0 ==
R  ->o  T0 : visible\n = true
R  ->  T1 : visible\n = false
R  ->  T0 : material\n = -0.1
R  ->o  T3 : visible\n = false
== Time: 0.5 ==
R  ->  T0 : material\n = 0.2
== Time: 1.0 ==
R  ->o  T0 : visible\n = false
R  ->  T0 : material\n = 1.0


....
---

==== pattern3

[plantuml]
....
control "Root" as R
participant "$Pattern1" as T0
participant "$Pattern2" as T1
participant "$Pattern3" as T2



== Time: 0.0 ==
R  ->  T0 : visible\n = false
R  ->o  T1 : visible\n = false
R  ->o  T2 : visible\n = true
R  ->  T2 : material\n = 1.0
== Time: 1.0 ==
R  ->  T2 : material\n = 0.0


....
---



=== Signal Connections
NOTE: No signal connections.

=== Properties
[cols="1,1,3" options="header"]
|===
|Section |Name |Value
|_sub_resource_ |*shader* |`ExtResource("2_rtx6v")`
|_sub_resource_ |*shader_parameter/radius* |`0.0`
|_sub_resource_ |*shader_parameter/center* |`Vector2(0.5, 0.5)`
|_sub_resource_ |*shader* |`ExtResource("3_sqii1")`
|_sub_resource_ |*shader_parameter/ratio* |`0.5`
|_sub_resource_ |*length* |`0.001`
|_sub_resource_ |*tracks/0/type* |`value`
|_sub_resource_ |*tracks/0/imported* |`false`
|_sub_resource_ |*tracks/0/enabled* |`true`
|_sub_resource_ |*tracks/0/path* |`NodePath("Pattern1/RightCurtain:polygon")`
|_sub_resource_ |*tracks/0/interp* |`1`
|_sub_resource_ |*tracks/0/loop_wrap* |`true`
|_sub_resource_ |*tracks/0/keys* |`{
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [PackedVector2Array(1920, 1080, 1920, 0, 960, 0, 1920, 540, 960, 1074)]
}`
|_sub_resource_ |*tracks/1/type* |`value`
|_sub_resource_ |*tracks/1/imported* |`false`
|_sub_resource_ |*tracks/1/enabled* |`true`
|_sub_resource_ |*tracks/1/path* |`NodePath("Pattern1/LeftCurtain:polygon")`
|_sub_resource_ |*tracks/1/interp* |`1`
|_sub_resource_ |*tracks/1/loop_wrap* |`true`
|_sub_resource_ |*tracks/1/keys* |`{
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [PackedVector2Array(0, 0, 0, 1080, 960, 1080, 9, 548, 960, 0)]
}`
|_sub_resource_ |*tracks/2/type* |`value`
|_sub_resource_ |*tracks/2/imported* |`false`
|_sub_resource_ |*tracks/2/enabled* |`true`
|_sub_resource_ |*tracks/2/path* |`NodePath("Pattern1:visible")`
|_sub_resource_ |*tracks/2/interp* |`1`
|_sub_resource_ |*tracks/2/loop_wrap* |`true`
|_sub_resource_ |*tracks/2/keys* |`{
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [false]
}`
|_sub_resource_ |*tracks/3/type* |`value`
|_sub_resource_ |*tracks/3/imported* |`false`
|_sub_resource_ |*tracks/3/enabled* |`true`
|_sub_resource_ |*tracks/3/path* |`NodePath("Pattern2:visible")`
|_sub_resource_ |*tracks/3/interp* |`1`
|_sub_resource_ |*tracks/3/loop_wrap* |`true`
|_sub_resource_ |*tracks/3/keys* |`{
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [false]
}`
|_sub_resource_ |*tracks/4/type* |`value`
|_sub_resource_ |*tracks/4/imported* |`false`
|_sub_resource_ |*tracks/4/enabled* |`true`
|_sub_resource_ |*tracks/4/path* |`NodePath("Pattern2:material:shader_parameter/radius")`
|_sub_resource_ |*tracks/4/interp* |`1`
|_sub_resource_ |*tracks/4/loop_wrap* |`true`
|_sub_resource_ |*tracks/4/keys* |`{
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [0.0]
}`
|_sub_resource_ |*tracks/5/type* |`value`
|_sub_resource_ |*tracks/5/imported* |`false`
|_sub_resource_ |*tracks/5/enabled* |`true`
|_sub_resource_ |*tracks/5/path* |`NodePath("Pattern3:visible")`
|_sub_resource_ |*tracks/5/interp* |`1`
|_sub_resource_ |*tracks/5/loop_wrap* |`true`
|_sub_resource_ |*tracks/5/keys* |`{
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [false]
}`
|_sub_resource_ |*tracks/6/type* |`value`
|_sub_resource_ |*tracks/6/imported* |`false`
|_sub_resource_ |*tracks/6/enabled* |`true`
|_sub_resource_ |*tracks/6/path* |`NodePath("Pattern3:material:shader_parameter/ratio")`
|_sub_resource_ |*tracks/6/interp* |`1`
|_sub_resource_ |*tracks/6/loop_wrap* |`true`
|_sub_resource_ |*tracks/6/keys* |`{
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [0.5]
}`
|_sub_resource_ |*resource_name* |`pattern1`
|_sub_resource_ |*tracks/0/type* |`value`
|_sub_resource_ |*tracks/0/imported* |`false`
|_sub_resource_ |*tracks/0/enabled* |`true`
|_sub_resource_ |*tracks/0/path* |`NodePath("Pattern1/RightCurtain:polygon")`
|_sub_resource_ |*tracks/0/interp* |`1`
|_sub_resource_ |*tracks/0/loop_wrap* |`true`
|_sub_resource_ |*tracks/0/keys* |`{
"times": PackedFloat32Array(0, 0.5, 1),
"transitions": PackedFloat32Array(1, 0.25, 1),
"update": 0,
"values": [PackedVector2Array(1920, 1080, 1920, 0, 960, 0, 960, 540, 960, 1080), PackedVector2Array(1920, 1080, 1920, 0, 960, 0, 1920, 540, 960, 1080), PackedVector2Array(1920, 1080, 1920, 0, 1920, 0, 1920, 540, 1920, 1080)]
}`
|_sub_resource_ |*tracks/1/type* |`value`
|_sub_resource_ |*tracks/1/imported* |`false`
|_sub_resource_ |*tracks/1/enabled* |`true`
|_sub_resource_ |*tracks/1/path* |`NodePath("Pattern1/LeftCurtain:polygon")`
|_sub_resource_ |*tracks/1/interp* |`1`
|_sub_resource_ |*tracks/1/loop_wrap* |`true`
|_sub_resource_ |*tracks/1/keys* |`{
"times": PackedFloat32Array(0, 0.5, 1),
"transitions": PackedFloat32Array(1, 0.25, 1),
"update": 0,
"values": [PackedVector2Array(0, 0, 0, 1080, 960, 1080, 960, 548, 960, 0), PackedVector2Array(0, 0, 0, 1080, 960, 1080, 0, 548, 960, 0), PackedVector2Array(0, 0, 0, 1080, 0, 1080, 0, 548, 0, 0)]
}`
|_sub_resource_ |*tracks/2/type* |`value`
|_sub_resource_ |*tracks/2/imported* |`false`
|_sub_resource_ |*tracks/2/enabled* |`true`
|_sub_resource_ |*tracks/2/path* |`NodePath("Pattern1:visible")`
|_sub_resource_ |*tracks/2/interp* |`1`
|_sub_resource_ |*tracks/2/loop_wrap* |`true`
|_sub_resource_ |*tracks/2/keys* |`{
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [true]
}`
|_sub_resource_ |*tracks/3/type* |`value`
|_sub_resource_ |*tracks/3/imported* |`false`
|_sub_resource_ |*tracks/3/enabled* |`true`
|_sub_resource_ |*tracks/3/path* |`NodePath("Pattern2:visible")`
|_sub_resource_ |*tracks/3/interp* |`1`
|_sub_resource_ |*tracks/3/loop_wrap* |`true`
|_sub_resource_ |*tracks/3/keys* |`{
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [false]
}`
|_sub_resource_ |*tracks/4/type* |`value`
|_sub_resource_ |*tracks/4/imported* |`false`
|_sub_resource_ |*tracks/4/enabled* |`true`
|_sub_resource_ |*tracks/4/path* |`NodePath("Pattern3:visible")`
|_sub_resource_ |*tracks/4/interp* |`1`
|_sub_resource_ |*tracks/4/loop_wrap* |`true`
|_sub_resource_ |*tracks/4/keys* |`{
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [false]
}`
|_sub_resource_ |*resource_name* |`pattern2`
|_sub_resource_ |*tracks/0/type* |`value`
|_sub_resource_ |*tracks/0/imported* |`false`
|_sub_resource_ |*tracks/0/enabled* |`true`
|_sub_resource_ |*tracks/0/path* |`NodePath("Pattern2:visible")`
|_sub_resource_ |*tracks/0/interp* |`1`
|_sub_resource_ |*tracks/0/loop_wrap* |`true`
|_sub_resource_ |*tracks/0/keys* |`{
"times": PackedFloat32Array(0, 1),
"transitions": PackedFloat32Array(1, 1),
"update": 1,
"values": [true, false]
}`
|_sub_resource_ |*tracks/1/type* |`value`
|_sub_resource_ |*tracks/1/imported* |`false`
|_sub_resource_ |*tracks/1/enabled* |`true`
|_sub_resource_ |*tracks/1/path* |`NodePath("Pattern1:visible")`
|_sub_resource_ |*tracks/1/interp* |`1`
|_sub_resource_ |*tracks/1/loop_wrap* |`true`
|_sub_resource_ |*tracks/1/keys* |`{
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [false]
}`
|_sub_resource_ |*tracks/2/type* |`value`
|_sub_resource_ |*tracks/2/imported* |`false`
|_sub_resource_ |*tracks/2/enabled* |`true`
|_sub_resource_ |*tracks/2/path* |`NodePath("Pattern2:material:shader_parameter/radius")`
|_sub_resource_ |*tracks/2/interp* |`1`
|_sub_resource_ |*tracks/2/loop_wrap* |`true`
|_sub_resource_ |*tracks/2/keys* |`{
"times": PackedFloat32Array(0, 0.5, 1),
"transitions": PackedFloat32Array(0.25, 1, 1),
"update": 0,
"values": [-0.1, 0.2, 1.0]
}`
|_sub_resource_ |*tracks/3/type* |`value`
|_sub_resource_ |*tracks/3/imported* |`false`
|_sub_resource_ |*tracks/3/enabled* |`true`
|_sub_resource_ |*tracks/3/path* |`NodePath("Pattern3:visible")`
|_sub_resource_ |*tracks/3/interp* |`1`
|_sub_resource_ |*tracks/3/loop_wrap* |`true`
|_sub_resource_ |*tracks/3/keys* |`{
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [false]
}`
|_sub_resource_ |*resource_name* |`pattern3`
|_sub_resource_ |*tracks/0/type* |`value`
|_sub_resource_ |*tracks/0/imported* |`false`
|_sub_resource_ |*tracks/0/enabled* |`true`
|_sub_resource_ |*tracks/0/path* |`NodePath("Pattern1:visible")`
|_sub_resource_ |*tracks/0/interp* |`1`
|_sub_resource_ |*tracks/0/loop_wrap* |`true`
|_sub_resource_ |*tracks/0/keys* |`{
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [false]
}`
|_sub_resource_ |*tracks/1/type* |`value`
|_sub_resource_ |*tracks/1/imported* |`false`
|_sub_resource_ |*tracks/1/enabled* |`true`
|_sub_resource_ |*tracks/1/path* |`NodePath("Pattern2:visible")`
|_sub_resource_ |*tracks/1/interp* |`1`
|_sub_resource_ |*tracks/1/loop_wrap* |`true`
|_sub_resource_ |*tracks/1/keys* |`{
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [false]
}`
|_sub_resource_ |*tracks/2/type* |`value`
|_sub_resource_ |*tracks/2/imported* |`false`
|_sub_resource_ |*tracks/2/enabled* |`true`
|_sub_resource_ |*tracks/2/path* |`NodePath("Pattern3:visible")`
|_sub_resource_ |*tracks/2/interp* |`1`
|_sub_resource_ |*tracks/2/loop_wrap* |`true`
|_sub_resource_ |*tracks/2/keys* |`{
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [true]
}`
|_sub_resource_ |*tracks/3/type* |`value`
|_sub_resource_ |*tracks/3/imported* |`false`
|_sub_resource_ |*tracks/3/enabled* |`true`
|_sub_resource_ |*tracks/3/path* |`NodePath("Pattern3:material:shader_parameter/ratio")`
|_sub_resource_ |*tracks/3/interp* |`1`
|_sub_resource_ |*tracks/3/loop_wrap* |`true`
|_sub_resource_ |*tracks/3/keys* |`{
"times": PackedFloat32Array(0, 1),
"transitions": PackedFloat32Array(0.5, 1),
"update": 0,
"values": [1.0, 0.0]
}`
|_sub_resource_ |*_data* |`{
&"RESET": SubResource("Animation_bwqwf"),
&"pattern1": SubResource("Animation_y3iny"),
&"pattern2": SubResource("Animation_kivlp"),
&"pattern3": SubResource("Animation_663td")
}`
|_node_ |*z_index* |`5`
|_node_ |*z_as_relative* |`false`
|_node_ |*layout_mode* |`3`
|_node_ |*anchors_preset* |`15`
|_node_ |*anchor_right* |`1.0`
|_node_ |*anchor_bottom* |`1.0`
|_node_ |*grow_horizontal* |`2`
|_node_ |*grow_vertical* |`2`
|_node_ |*script* |`ExtResource("1_2igm1")`
|_node_ |*visible* |`false`
|_node_ |*color* |`Color(0, 0, 0, 1)`
|_node_ |*polygon* |`PackedVector2Array(0, 0, 0, 1080, 960, 1080, 9, 548, 960, 0)`
|_node_ |*uv* |`PackedVector2Array(572.5, -87.75, 575.5, -85.75)`
|_node_ |*color* |`Color(0, 0, 0, 1)`
|_node_ |*polygon* |`PackedVector2Array(1920, 1080, 1920, 0, 960, 0, 1920, 540, 960, 1074)`
|_node_ |*uv* |`PackedVector2Array(1920, 1080, 1920, 0, 960, 0, 960, 540, 960, 1080, 492, 40.75)`
|_node_ |*unique_name_in_owner* |`true`
|_node_ |*visible* |`false`
|_node_ |*material* |`SubResource("ShaderMaterial_kivlp")`
|_node_ |*layout_mode* |`1`
|_node_ |*anchors_preset* |`-1`
|_node_ |*anchor_right* |`1.0`
|_node_ |*anchor_bottom* |`1.0`
|_node_ |*offset_top* |`-450.0`
|_node_ |*offset_bottom* |`390.0`
|_node_ |*grow_horizontal* |`2`
|_node_ |*grow_vertical* |`2`
|_node_ |*visible* |`false`
|_node_ |*material* |`SubResource("ShaderMaterial_663td")`
|_node_ |*layout_mode* |`1`
|_node_ |*anchors_preset* |`15`
|_node_ |*anchor_right* |`1.0`
|_node_ |*anchor_bottom* |`1.0`
|_node_ |*grow_horizontal* |`2`
|_node_ |*grow_vertical* |`2`
|_node_ |*unique_name_in_owner* |`true`
|_node_ |*libraries* |`{
&"": SubResource("AnimationLibrary_kivlp")
}`
|===


=== link:/scripts/src/curtain/opening/opening.gd[opening.gd]

```gdscript
extends Control

enum Pattern { PATTERN_1, PATTERN_2, PATTERN_3 }
@export var pattern : Pattern
@export var center := Vector2(0.5, 0.5) : set = set_center


func set_center(val: Vector2) -> void:
	center = val
	%Pattern2.material.set_shader_parameter("center", val)


func play() -> void:
	var number = Pattern.keys()[pattern].split('_')[1]
	%AnimationPlayer.play("pattern%s" % number)

```


